# ü§ñ AI News Bot

**AI News Bot** ‚Äî —Ü–µ Telegram –±–æ—Ç, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–∏—Ä–∞—î, –∞–Ω–∞–ª—ñ–∑—É—î —Ç–∞ –ø—É–±–ª—ñ–∫—É—î –Ω–æ–≤–∏–Ω–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —à—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—ó —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —â–æ–¥–µ–Ω–Ω–∏—Ö –¥–∞–π–¥–∂–µ—Å—Ç—ñ–≤.

## üìã –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–±—ñ—Ä –Ω–æ–≤–∏–Ω** –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª
- **AI-–∞–Ω–∞–ª—ñ–∑** —Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—è –Ω–æ–≤–∏–Ω
- **–©–æ–¥–µ–Ω–Ω—ñ –¥–∞–π–¥–∂–µ—Å—Ç–∏** –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–º–∏ –Ω–æ–≤–∏–Ω–∞–º–∏
- **–ú–∏—Ç—Ç—î–≤—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è** –ø—Ä–æ –≤–∞–∂–ª–∏–≤—ñ –Ω–æ–≤–∏–Ω–∏
- **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å** –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏

## üõ† –¢–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—Ç–µ–∫

- **Python 3.11**
- **Docker** –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—ó
- **Telegram Bot API** –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
- **GitHub Actions** –¥–ª—è CI/CD
- **Prometheus** –¥–ª—è –º–µ—Ç—Ä–∏–∫
- **Sentry** –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –ø–æ–º–∏–ª–æ–∫
- **LLM**: Gemini 1.5 Flash + OpenAI GPT-4

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
ai-news-bot/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ bot.py          # –û—Å–Ω–æ–≤–Ω–∏–π –∫–ª–∞—Å –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py       # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (Settings)
‚îÇ   ‚îú‚îÄ‚îÄ metrics.py      # –ú–µ—Ç—Ä–∏–∫–∏ Prometheus
‚îÇ   ‚îú‚îÄ‚îÄ news/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ collector.py # –ó–±—ñ—Ä –Ω–æ–≤–∏–Ω
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analyzer.py  # AI-–∞–Ω–∞–ª—ñ–∑ –Ω–æ–≤–∏–Ω
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ helpers.py   # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_bot.py     # –¢–µ—Å—Ç–∏ –¥–ª—è –±–æ—Ç–∞
‚îú‚îÄ‚îÄ .env                # –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ (–Ω–µ –≤–∫–ª—é—á–µ–Ω–æ –≤ Git)
‚îú‚îÄ‚îÄ .flake8            # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è flake8
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ main.yml    # CI/CD –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ Dockerfile         # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Docker
‚îú‚îÄ‚îÄ requirements.txt   # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python
‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
```

## üöÄ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### –õ–æ–∫–∞–ª—å–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ö–ª–æ–Ω—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:**
   ```bash
   git clone https://github.com/–¢–í–Ü–ô_–õ–û–ì–Ü–ù/ai-news-bot.git
   cd ai-news-bot
   ```

2. **–°—Ç–≤–æ—Ä–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ:**
   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   # –∞–±–æ
   venv\Scripts\activate  # Windows
   ```

3. **–í—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:**
   ```bash
   pip install -r requirements.txt
   ```

4. **–°—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª `.env` –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏:**
   ```
   # Telegram
   TELEGRAM_TOKEN=—Ç–≤—ñ–π_—Ç–æ–∫–µ–Ω
   TELEGRAM_CHANNEL_ID=—Ç–≤—ñ–π_–∫–∞–Ω–∞–ª
   ADMIN_IDS=—Ç–≤—ñ–π_id
   
   # LLM API Keys
   OPENAI_API_KEY=—Ç–≤—ñ–π_–∫–ª—é—á
   GOOGLE_API_KEY=—Ç–≤—ñ–π_–∫–ª—é—á
   
   # Monitoring
   SENTRY_DSN=—Ç–≤—ñ–π_dsn
   ENABLE_METRICS=true
   METRICS_PORT=9090
   ```

5. **–ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞:**
   ```bash
   python -m app.bot
   ```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

1. **–ó–±–µ—Ä–∏ Docker-–æ–±—Ä–∞–∑:**
   ```bash
   docker build -t ai-news-bot .
   ```

2. **–ó–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**
   ```bash
   docker run -d \
     --name ai-news-bot \
     -p 9090:9090 \
     -v $(pwd)/data.db:/app/data.db \
     --env-file .env \
     ai-news-bot
   ```

### –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

1. **–°—Ç–≤–æ—Ä–∏ systemd —Å–µ—Ä–≤—ñ—Å:**
   ```ini
   # /etc/systemd/system/ai-news-bot.service
   [Unit]
   Description=AI News Bot
   After=network.target
   
   [Service]
   Type=simple
   User=ai-news-bot
   WorkingDirectory=/opt/ai-news-bot
   Environment=PYTHONPATH=/opt/ai-news-bot
   ExecStart=/usr/local/bin/docker-compose up
   ExecStop=/usr/local/bin/docker-compose down
   Restart=always
   RestartSec=10
   
   [Install]
   WantedBy=multi-user.target
   ```

2. **–°—Ç–≤–æ—Ä–∏ docker-compose.yml:**
   ```yaml
   version: '3'
   services:
     bot:
       image: ai-news-bot:latest
       ports:
         - "9090:9090"
       volumes:
         - ./data.db:/app/data.db
       env_file:
         - .env
       restart: unless-stopped
   ```

3. **–ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤—ñ—Å:**
   ```bash
   sudo systemctl enable ai-news-bot
   sudo systemctl start ai-news-bot
   ```

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### Prometheus –º–µ—Ç—Ä–∏–∫–∏

- **/metrics** endpoint –Ω–∞ –ø–æ—Ä—Ç—É 9090
- –û—Å–Ω–æ–≤–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏:
  - `news_processed_total` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö –Ω–æ–≤–∏–Ω
  - `news_impact` - —Ä–æ–∑–ø–æ–¥—ñ–ª impact-–æ—Ü—ñ–Ω–æ–∫
  - `llm_requests_total` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ LLM
  - `llm_cost_usd` - –≤–∞—Ä—Ç—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è LLM
  - `duplicate_rate` - –≤—ñ–¥—Å–æ—Ç–æ–∫ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤

### Sentry

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–±—ñ—Ä –ø–æ–º–∏–ª–æ–∫
- –¢—Ä–µ–π—Å–∏ –∑–∞–ø–∏—Ç—ñ–≤
- –ü—Ä–æ—Ñ—ñ–ª—é–≤–∞–Ω–Ω—è

### Health check

- **/healthz** endpoint –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞–Ω—É —Å–µ—Ä–≤—ñ—Å—É
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î:
  - –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
  - –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
  - –í–µ—Ä—Å—ñ—é –¥–æ–¥–∞—Ç–∫—É

## üìù –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤

- `/stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–æ–≤–∏–Ω
- `/digest now` ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∞–π–¥–∂–µ—Å—Ç –∑–∞—Ä–∞–∑
- `/toggle [—Ñ—É–Ω–∫—Ü—ñ—è]` ‚Äî —É–≤—ñ–º–∫–Ω—É—Ç–∏/–≤–∏–º–∫–Ω—É—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

- **–©–æ–¥–µ–Ω–Ω–∏–π –¥–∞–π–¥–∂–µ—Å—Ç** ‚Äî –ø—É–±–ª—ñ–∫—É—î—Ç—å—Å—è –æ 20:00
- **Breaking news** ‚Äî –º–∏—Ç—Ç—î–≤—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –≤–∞–∂–ª–∏–≤—ñ –Ω–æ–≤–∏–Ω–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö unit-—Ç–µ—Å—Ç–æ–≤
pytest tests/unit -v

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pytest tests/unit/test_summarizer.py -v

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest tests/unit --cov=app --cov-report=term-missing
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/integration -v

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/integration --cov=app --cov-report=term-missing
```

### Load —Ç–µ—Å—Ç—ã
```bash
# –ó–∞–ø—É—Å–∫ Locust
locust -f tests/load/locustfile.py

# –ó–∞–ø—É—Å–∫ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
locust -f tests/load/locustfile.py --users 100 --spawn-rate 10 --host http://localhost:8000
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
```bash
# –õ–∏–Ω—Ç–∏–Ω–≥
ruff check .

# –¢–∏–ø–∏–∑–∞—Ü–∏—è
mypy app/

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
ruff format .
```

### CI/CD Pipeline
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤
2. –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
4. –õ–∏–Ω—Ç–∏–Ω–≥
5. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
6. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
7. –î–µ–ø–ª–æ–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
–ü—Ä–æ–µ–∫—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω —Å —É—á–µ—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö LLM –º–æ–¥–µ–ª–µ–π
3. –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
5. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
1. –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–æ–≤–æ—Å—Ç–µ–π
3. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö LLM –º–æ–¥–µ–ª–µ–π
4. –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫
5. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

## üîÑ CI/CD

–ü—Ä–æ—î–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î GitHub Actions –¥–ª—è:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- –õ—ñ–Ω—Ç—É–≤–∞–Ω–Ω—è –∫–æ–¥—É
- –ó–±—ñ—Ä–∫–∏ Docker-–æ–±—Ä–∞–∑—É
- –î–µ–ø–ª–æ—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT

## üë• –ê–≤—Ç–æ—Ä–∏

- –¢–≤–æ—î —ñ–º'—è ‚Äî [GitHub](https://github.com/–¢–í–Ü–ô_–õ–û–ì–Ü–ù)

---

**–ü—Ä–∏—î–º–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üöÄ 